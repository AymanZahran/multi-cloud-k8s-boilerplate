{
  "//": {
    "metadata": {
      "backend": "remote",
      "cloud": "tfc",
      "stackName": "dev",
      "version": "0.17.1"
    },
    "outputs": {
      "dev": {
        "aks_provider_endpoint": "aks_provider_endpoint",
        "aks_provider_key": "aks_provider_key",
        "eks_provider_endpoint": "eks_provider_endpoint",
        "eks_provider_key": "eks_provider_key"
      }
    }
  },
  "output": {
    "aks_provider_endpoint": {
      "description": "The AKS provider endpoint",
      "value": "${azurerm_kubernetes_cluster.aks_cluster.id}"
    },
    "aks_provider_key": {
      "description": "The AKS provider key"
    },
    "eks_provider_endpoint": {
      "description": "The EKS provider endpoint",
      "value": "${aws_eks_cluster.eks_cluster.endpoint}"
    },
    "eks_provider_key": {
      "description": "The EKS provider key"
    }
  },
  "provider": {
    "aws": [
      {
        "access_key": "",
        "region": "us-east-2",
        "secret_key": ""
      }
    ],
    "azurerm": [
      {
        "client_id": "",
        "client_secret": "",
        "features": {
        },
        "subscription_id": "",
        "tenant_id": ""
      }
    ],
    "kubernetes": [
      {
        "cluster_ca_certificate": "${base64decode(aws_eks_cluster.eks_cluster.certificate_authority[0].data)}",
        "host": "${aws_eks_cluster.eks_cluster.endpoint}"
      },
      {
        "cluster_ca_certificate": "${azurerm_kubernetes_cluster.aks_cluster.kube_config_raw}",
        "host": "${azurerm_kubernetes_cluster.aks_cluster.id}"
      }
    ]
  },
  "resource": {
    "aws_eks_cluster": {
      "eks_cluster": {
        "//": {
          "metadata": {
            "path": "dev/eks_cluster",
            "uniqueId": "eks_cluster"
          }
        },
        "name": "${var.eks_cluster_name}",
        "role_arn": "${var.eks_control_plane_role_arn}",
        "tags": {
          "environment": "dev"
        },
        "version": "${var.eks_control_plane_version}",
        "vpc_config": {
          "subnet_ids": [
          ]
        }
      }
    },
    "aws_eks_node_group": {
      "eks_node_group": {
        "//": {
          "metadata": {
            "path": "dev/eks_node_group",
            "uniqueId": "eks_node_group"
          }
        },
        "cluster_name": "${aws_eks_cluster.eks_cluster.name}",
        "node_group_name": "${var.eks_node_group_name}",
        "node_role_arn": "${var.eks_data_plane_role_arn}",
        "scaling_config": {
          "desired_size": "${var.eks_node_group_desired_size}",
          "max_size": "${var.eks_node_group_max_size}",
          "min_size": "${var.eks_node_group_min_size}"
        },
        "subnet_ids": [
        ],
        "tags": {
          "environment": "dev"
        },
        "version": "${var.eks_data_plane_version}"
      }
    },
    "aws_vpc": {
      "vpc": {
        "//": {
          "metadata": {
            "path": "dev/vpc",
            "uniqueId": "vpc"
          }
        },
        "cidr_block": "${var.vpc_cidr}",
        "enable_dns_hostnames": "${var.enable_dns_hostnames}",
        "tags": {
          "environment": "dev"
        }
      }
    },
    "azurerm_kubernetes_cluster": {
      "aks_cluster": {
        "//": {
          "metadata": {
            "path": "dev/aks_cluster",
            "uniqueId": "aks_cluster"
          }
        },
        "default_node_pool": {
          "max_count": "${var.aks_node_pool_max_count}",
          "min_count": "${var.aks_node_pool_min_count}",
          "name": "${var.aks_node_pool_name}",
          "node_count": "${var.aks_node_pool_count}",
          "orchestrator_version": "${var.aks_data_plane_version}",
          "pod_subnet_id": "${azurerm_subnet.aks-subnet.id}",
          "vm_size": "${var.aks_node_pool_vm_size}",
          "vnet_subnet_id": "${azurerm_subnet.aks-subnet.id}"
        },
        "kubernetes_version": "${var.aks_control_plane_version}",
        "location": "eastus2",
        "name": "${var.aks_cluster_name}",
        "resource_group_name": "${var.aks_resource_group_name}",
        "tags": {
          "environment": "dev"
        }
      }
    },
    "azurerm_subnet": {
      "aks-subnet": {
        "//": {
          "metadata": {
            "path": "dev/aks-subnet",
            "uniqueId": "aks-subnet"
          }
        },
        "address_prefixes": "${var.aks_subnet_cidr_block}",
        "name": "${var.aks_subnet_name}",
        "resource_group_name": "${var.aks_resource_group_name}",
        "virtual_network_name": "${azurerm_virtual_network.vnet.name}"
      }
    },
    "azurerm_virtual_network": {
      "vnet": {
        "//": {
          "metadata": {
            "path": "dev/vnet",
            "uniqueId": "vnet"
          }
        },
        "address_space": [
          "${var.aks_vnet_cidr_block}"
        ],
        "location": "eastus2",
        "name": "${var.aks_vnet_name}",
        "resource_group_name": "${var.aks_resource_group_name}",
        "tags": {
          "environment": "dev"
        }
      }
    },
    "kubernetes_manifest": {
      "argo-cd": {
        "//": {
          "metadata": {
            "path": "dev/argo-cd",
            "uniqueId": "argo-cd"
          }
        },
        "manifest": {
          "__filename": "../kubernetes/dev/argo-cd.yaml"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "remote": {
        "hostname": "app.terraform.io",
        "organization": "multi-cloud-pipelines",
        "workspaces": {
          "name": "dev"
        }
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "4.67.0"
      },
      "azurerm": {
        "source": "azurerm",
        "version": "3.61.0"
      },
      "kubernetes": {
        "source": "kubernetes",
        "version": "2.21.1"
      }
    }
  },
  "variable": {
    "aks_cluster_name": {
      "default": "dev-aks-cluster",
      "description": "The name of the AKS cluster",
      "type": "string"
    },
    "aks_control_plane_version": {
      "default": "1.24",
      "description": "The version of the AKS control plane",
      "type": "string"
    },
    "aks_data_plane_version": {
      "default": "1.24",
      "description": "The version of the AKS data plane",
      "type": "string"
    },
    "aks_node_pool_count": {
      "default": 2,
      "description": "The size of the AKS node pool",
      "type": "number"
    },
    "aks_node_pool_max_count": {
      "default": 2,
      "description": "The maximum size of the AKS node pool",
      "type": "number"
    },
    "aks_node_pool_min_count": {
      "default": 2,
      "description": "The minimum size of the AKS node pool",
      "type": "number"
    },
    "aks_node_pool_name": {
      "default": "dev-aks-node-pool",
      "description": "The name of the AKS node pool",
      "type": "string"
    },
    "aks_node_pool_vm_size": {
      "default": "Standard_D2_v2",
      "description": "The VM size of the AKS node pool",
      "type": "string"
    },
    "aks_resource_group_name": {
      "default": "dev-aks-cluster",
      "description": "The name of the AKS resource group",
      "type": "string"
    },
    "aks_subnet_cidr_block": {
      "default": "10.0.0.0/16",
      "description": "The CIDR block for the AKS Subnet",
      "type": "string"
    },
    "aks_subnet_name": {
      "default": "dev-subnet-aks-cluster",
      "description": "The name of the AKS Subnet",
      "type": "string"
    },
    "aks_vnet_cidr_block": {
      "default": "10.0.0.0/16",
      "description": "The CIDR block for the AKS VNet",
      "type": "string"
    },
    "aks_vnet_name": {
      "default": "dev-vnet-aks-cluster",
      "description": "The name of the AKS VNet",
      "type": "string"
    },
    "eks_cluster_name": {
      "default": "dev-eks-cluster",
      "description": "The name of the EKS cluster",
      "type": "string"
    },
    "eks_control_plane_role_arn": {
      "default": "arn:aws:iam::123456789012:role/eks-control-plane-role",
      "description": "The ARN of the IAM role for the EKS control plane",
      "type": "string"
    },
    "eks_control_plane_version": {
      "default": "1.24",
      "description": "The version of the EKS control plane",
      "type": "string"
    },
    "eks_data_plane_role_arn": {
      "default": "arn:aws:iam::123456789012:role/eks-data-plane-role",
      "description": "The ARN of the IAM role for the EKS data plane",
      "type": "string"
    },
    "eks_data_plane_version": {
      "default": "1.24",
      "description": "The version of the EKS data plane",
      "type": "string"
    },
    "eks_node_group_desired_size": {
      "default": 2,
      "description": "The desired size of the EKS node group",
      "type": "number"
    },
    "eks_node_group_max_size": {
      "default": 2,
      "description": "The maximum size of the EKS node group",
      "type": "number"
    },
    "eks_node_group_min_size": {
      "default": 2,
      "description": "The minimum size of the EKS node group",
      "type": "number"
    },
    "eks_node_group_name": {
      "default": "dev-eks-node-group",
      "description": "The name of the EKS node group",
      "type": "string"
    },
    "enable_dns_hostnames": {
      "default": true,
      "description": "A boolean flag to enable/disable DNS hostnames in the VPC",
      "type": "string"
    },
    "number_of_subnets": {
      "default": 3,
      "description": "The number of subnets to create in the VPC",
      "type": "number"
    },
    "vpc_cidr": {
      "default": "10.0.0.0/16",
      "description": "The CIDR block for the VPC",
      "type": "string"
    }
  }
}